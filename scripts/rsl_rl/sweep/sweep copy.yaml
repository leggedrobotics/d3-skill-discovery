# https://docs.wandb.ai/guides/sweeps/sweep-config-keys/#distribution-options-for-random-and-bayesian-search
program: unsupervised_RL/scripts/rsl_rl/train.py
# program: scripts/rsl_rl/train.py
description: "Sweep over hyperparameters for factorized usd (metra, diayn) ppo anymal"
method: bayes  # or 'grid', 'random'
metric:
  name: Factor_Metrics/position  # wandb metric to optimize
  goal: maximize  # 'minimize' or 'maximize' if optimizing a loss
parameters:
# agent
  # agent.num_steps_per_env:
  #   values: [25, 49, 97]
  # agent.empirical_normalization:
  #   values: [True]
  agent.seed:
    min: 0
    max: 1000
# usd
  # agent.usd.reward_normalization:
  #   values: [true]
  # agent.usd.target_steps_to_goal:
  #   min: 100
  #   max: 10000
  #   distribution: log_uniform_values
  # agent.usd.factor_weight_lr:
  #   min: 0.1
  #   max: 100.0
  #   distribution: log_uniform_values
  # agent.algorithm.symmetry_augmentation:
  #   values: [False]
  # agent.algorithm.use_symmetry_aug_for_surrogate:
  #   values: [True, False]
  # agent.algorithm.force_reward_symmetry:
  #   values: [True, False]
  # agent.usd.regularize_factor_weights:
  #   min: 0.0
  #   max: 1.0
  # agent.usd.extrinsic_reward_scale:
  #   min: 1.0
  #   max: 2.0
  #   distribution: log_uniform_values
# # metra
#   agent.usd.metra.lambda_exploration:
#     min: 10.0
#     max: 1000.0
#     distribution: log_uniform_values
#   agent.usd.metra.ensemble_size:
#     values: [1, 20]
# # diayn
  # agent.usd.diayn.lambda_exploration:
  #   min: 0.5
  #   max: 2.0
  #   distribution: log_uniform_values
#   agent.usd.diayn.num_discriminators:
#     values: [1, 20]
  # agent.usd.diayn.rnd_weight:
  #   min: 0.1
  #   max: 1.0
  #   distribution: log_uniform_values
  # agent.usd.factor_weights_skew:
  #   min: 1.0
  #   max: 5.0
  #   distribution: log_uniform_values
  agent.num_steps_per_env:
    values: [25]




#   - --task=Isaac-USD-Anymal-D-v0 
#   - --task=Isaac-USD-AnymalBox-D-v0
#   - --task=Isaac-USD-AnymalBoxes-D-v0


command:
  - /isaac-sim/python.sh
  - ${program}
  - --task=Isaac-USD-Anymal-D-v0 
  - --num_envs=2048 #16384 8192 4096 2048 
  - --logger=wandb
  - --headless
  # - --enable_cameras
  # - --resume=RESUME
  # - --load_run=obstacle_avoidance_euler_02


  - ${args_no_hyphens}

  # - --video
  # - --video_length=400
  # - --video_interval=150000
